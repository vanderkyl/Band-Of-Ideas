<div id="ideaView">
  <!-- Idea Section - Displayed when a file is opened -->
  <div id="ideaSection">
    <div class="filePage">

      <!-- Container that holds an opened file -->
      <div id="file">

        <!-- Band Name | Folder Name -->
        <div class="containers">
          <span class="backToButton" ng-click="goBackToBandPage()">{{ band.name }}</span> | <span class="backToButton" ng-click="goBackToFolderPage()">{{ folder.name }}</span>
        </div>

        <div id="ideaContainer">
          <div id="ideaLoading" class="loader"></div>
          <div id="idea" class="containers col-xs-12">
            <a href="javascript:void(0)" id="ideaInfoButton" class="glyphicon glyphicon-info-sign" data-toggle="modal" data-target="#ideaDetailsModal"></a>
            <p id="fileTitle" class="fileTitle col-xs-12">{{ file.name }}</p>
            <div class="col-xs-12 noselect">
                <audio id="audio" ontimeupdate="initProgressBar()" style="display:none;" class="col-xs-12" preload="auto" controls>
                  <source id="m4aSource" ng-src="{{ file.link }}" type="audio/mp4"/>
                  <p>Your browser does not support HTML5 audio.</p>
                </audio>

                <div style="text-align:center">
                  <i class="playerButton glyphicon glyphicon-step-backward" ng-click="playPrev()"></i>
                  <i id="rewindButton" class="playerButton glyphicon glyphicon-backward" ng-click="rewind()"></i>
                  <i id="play-btn" class="playerButton glyphicon glyphicon-play" style="display:none;" ng-click="play()"></i>
                  <i id="pause-btn" class="playerButton glyphicon glyphicon-pause" style="display:inline-block" ng-click="pause()"></i>
                  <i id="forwardButton" class="playerButton glyphicon glyphicon-forward" ng-click="fastForward()"></i>
                  <i class="playerButton glyphicon glyphicon-step-forward" ng-click="playNext()"></i>
                </div>
              <p id="audioTime" class="col-xs-12"></p>
                <div id="audioTimeline" class="col-xs-12">
                  <div ng-repeat="highlight in file.highlights">

                    <div class="timelineHighlights" style="margin-left:{{highlight.position}}%" ng-if="highlight.highlightTime !== ''" >
                      <div class="highlightBubble">
                        <div class="highlightTime" ng-click="playHighlight($event, highlight.highlightTime)">
                          <img src="../img/timeButton.png"/> {{ currentTimeToString(highlight.highlightTime) }}
                        </div>
                        <div class="highlightComment" ng-click="playHighlight($event, highlight.highlightTime)">
                          <strong>{{ highlight.userName }}</strong><br>
                          <span>{{ highlight.comment }}</span>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div id="audioFilePercentageBar"></div>
                </div>

                <!--<div id="waveform" class="col-xs-12"></div>-->

            </div>
            <br>
          </div>

          <br>
        </div>
        <div id="sourceVideoDiv" class="videoWrapper col-xs-12" style="display: none">
          <iframe id="sourceVideo" width="560" height="349" scrolling="no" style="overflow: hidden;" src=""></iframe>
        </div>
        <!-- Buttons -->
        <div class="containers ideaButtons">
          <div id="likeButton-{{file.id}}"  class="likes ideaButton" ng-click="favoriteFile()">
            <span class="ideaButtonText">{{ file.likes }}</span>
            <img src="../img/black-metal.png"/>
            <p class="ideaButtonText">Favorite</p>
          </div>
          <div id="likedButton-{{file.id}}" class="likedButton ideaButton" ng-click="stopPropogation($event); showLikesOnFile(file); ">
            <span class="ideaButtonText">{{ file.likes }}</span>
            <img src="../img/metal.png"/>
            <p class="ideaButtonText">Favorited</p>
          </div>
          <div class="ideaButton" ng-click="openAddToPlaylistModal()">
            + <i class="far fa-list-alt"></i>
            <p class="ideaButtonText">Playlist</p>
          </div>
          <div class="ideaButton" ng-click="openSourceVideo()">
            <i class="fas fa-film"></i>
            <p id="sourceVideoButtonText" class="ideaButtonText">Video</p>
          </div>
          <div class="ideaButton" ng-click="openMiniPlayer()">
            <img src="img/playButton.png">
            <p class="ideaButtonText">Mini Player</p>
          </div>
          <div class="ideaButton" ng-click="downloadFromFile()">
            <img src="img/black-downloadButton.png">
            <p class="ideaButtonText">Download</p>
          </div>
        </div>
        <div id="commentContainer" class="containers col-xs-12 col-sm-6">
          <!-- File Data, Buttons, Comments, and Highlights -->
          <div class="col-xs-12 ideaButtons commentHeader">

            <a id="userCommentLink" href="/#/user" style="float: left;">
              <div id="userCommentImage" class="profileImage commentImage"></div>
            </a>
            <input id="commentInput" type="text" placeholder="Comment..." onfocus="showAddCommentButton()" onblur="hideAddCommentButton()" class="form-control" />
            <div id="highlightButton" class="highlight ideaButton text-center" style="cursor: pointer" ng-click="highlight()"><img width="15px" height="15px" src="../img/timeButton.png"/></div>
            <input id="addCommentButton" type='button' class="btn btn-success btn-sm" value='+' ng-click='submitComment(file)'/>
            <div id="highlightInputContainer" style="display: none">
              <div class="col-xs-12 noselect" style="padding: 0">
                <div id="momentIndicator" class="containers col-xs-12" style="font-size: 14px;" >



                  <div class="col-xs-9" style="font-size: 11px; cursor: pointer; padding-left: 0;">
                    <div class="col-xs-12" style="border: 1px solid #CCC; border-radius: 10px; margin-bottom: 2px">
                      <span>{{ currentTimeToString(currentTime) }}</span>
                    </div>
                    <div class="col-xs-4 hiddenButton" ng-click="rewindHighlight()">
                      <i class="glyphicon glyphicon-backward"></i>
                    </div>
                    <div class="col-xs-4 hiddenButton" ng-click="playNewHighlight()">
                      <i class="glyphicon glyphicon-play"></i>
                    </div>
                    <div class="col-xs-4 hiddenButton" ng-click="fastForwardHighlight()">
                      <i class="glyphicon glyphicon-forward" ></i>
                    </div>
                  </div>
                  <div class="text-center col-xs-3" style="font-size: 11px; padding: 0;" ng-click="highlightMoment($event)">

                    <div id="markHighlightButton" class="hiddenButton col-xs-12">
                      <img src="../img/timeButton.png"/>
                    </div>

                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Start of Highlights -->
          <div id="highlights" class="col-xs-12">
            <div id="highlightDetails" style="">
              <div class="commentButtons">

              </div>

            </div>

            <!-- List of Highlights -->
            <div ng-repeat="highlightObject in file.highlights | reverse | limitTo:maxHighlights" class="fileComments col-xs-12">
              <div class="userComment col-xs-12">
                <p class="highlightUserName col-xs-4"><b>{{ highlightObject.userName }}</b></p>
                <p class="commentTime col-xs-8"><i>{{ highlightObject.commentTime }}</i></p>
                <p class="commentText col-xs-10">{{ highlightObject.comment }}</p>
                <p class="highlightPlayButton" ng-if="highlightObject.highlightTime !== ''" ng-click="playHighlight($event, highlightObject.highlightTime)"> <img src="../img/timeButton.png"/> {{ currentTimeToString(highlightObject.highlightTime) }}</p>
              </div>
            </div>
            <div id="showHighlightsButton" class="commentButton col-xs-12" ng-disabled="file.highlights.length < maxHighlights" ng-click="showAllHighlights()">Show All Highlights ({{file.highlights.length}})</div>
            <div id="hideHighlightsButton" class="commentButton col-xs-12" ng-click="hideHighlights()">Hide Highlights</div>
          </div>
          <!-- End of Highlights -->
          <!-- Start of Comments -->
          <div id="comments" class="col-xs-12 scroller">
            <!--
            <div class="commentButtons">
              <div id="commentButton" class="comment text-center" style="cursor: pointer" ng-click="comment($event)"><img width="20px" height="20px" src="../img/commentButton.png"/> Comment</div>
            </div>

            <div id="commentInput" style="display: none">
              <textarea id="commentText" cols="74" rows="2" type="text" name="comment" placeholder="Comment..."></textarea>
              <input type='button' class="btn btn-default btn-md" value='Submit Comment' ng-click='submitComment(file)'/>
            </div>
            -->
            <!-- List of Comments -->
            <div ng-repeat="commentObject in file.highlights | reverse " class="fileComments col-xs-12">
              <div class="userComment col-xs-12">
                <p class="commentUserName col-xs-5"><b>{{ commentObject.userName }}</b></p>
                <p class="commentTime col-xs-7"><i>{{ commentObject.commentTime }}</i></p>
                <p class="commentText col-xs-10">{{ commentObject.comment }}</p>
                <p class="highlightPlayButton" ng-if="commentObject.highlightTime !== ''" ng-click="playHighlight($event, commentObject.highlightTime)"> <img src="../img/timeButton.png"/> {{ currentTimeToString(commentObject.highlightTime) }}</p>
              </div>
            </div>
            <!--
            <div id="showCommentsButton" class="commentButton col-xs-12" ng-disabled="file.comments.length < maxComments" ng-click="showAllComments()">Show All Comments ({{file.comments.length}})</div>
            <div id="hideCommentsButton" class="commentButton col-xs-12" ng-click="hideComments()">Hide Comments</div>
            -->
          </div>
          <!-- End of Comments -->
        </div>
        <!-- Container that holds all files playlist -->
        <div id="fileList" class="col-xs-12 col-sm-6">
          <div id="fileScroller" class="col-xs-12">
            <div ng-animate="'animate'" ng-repeat="song in files |
            filter:{name: search }
            | orderBy:sortBy" class="">
              <!-- This is a Single File -->
              <div id="file-{{ song.id }}" class="playListFile col-xs-12" data-index="{{ song.fileIndex }}" ng-click="openFile(song)">
                <div class="playListFileInfo col-xs-12">
                  <!-- <p class="deleteButton" ng-click="deleteFile($index)"> x </p>-->
                  <p class="col-sm-4 col-xs-12">{{ song.name }}</p>
                  <p class="col-sm-8 col-xs-12">{{ song.likes }} <img src="../img/black-metal.png"/> | {{ song.views }} <img src="../img/music.png"/> | {{ song.comments.length }} <img src="../img/commentButton.png"/> | {{ song.highlights.length }} <img src="../img/timeButton.png"/></p>
                </div>
              </div>
              <!-- End of Single File -->
            </div>
          </div>
          <!--
          <div id="pagination" class="col-xs-12" data-pagination="" data-num-pages="numberOfPages()"
               data-current-page="currentPage" data-max-size="maxSize"
               data-boundary-links="true"></div> -->
          <!-- End of File Navigation -->
        </div>
        <!-- End of Playlist -->
        <!-- File Navigation -->

      </div>
      <!-- End of File -->
  </div>
</div>
</div>
<idea-details-modal></idea-details-modal>
<!-- Add Source Video Modal -->
<div id="addVideoModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Add Source Video</h4>
      </div>
      <div class="modal-body modalForm">
        <input type="text" name="sourceVideoLink" placeholder="Source Video Link" ng-model="sourceVideoLink" style="width:100%" required/>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-success" ng-click="addSourceVideo()">Add Video</button>
      </div>
    </div>
  </div>
</div>

<!-- End of Video Modal -->

<!-- Add To Playlist Modal -->
<div id="addToPlaylistModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Add to Playlist</h4>
      </div>
      <div class="modal-body">
        <div class="button homeButton" style="width: 80%; margin: 0 auto;" data-toggle="modal" data-target="#addPlaylistModal">Add Playlist</div>
        <div style="padding: 15px">
          <div id="{{ 'playlist-' + $index }}" ng-animate="'animate'" ng-repeat="playlist in playlists" class="playlistButton col-xs-12" >

            <div class="playlistDetails col-xs-6">
              <div>{{ playlist.name }}</div>
            </div>
            <div class="playlistDetailsButton btn btn-default col-xs-3" data-dismiss="modal" ng-click="openPlaylist(playlist)">
              Open
            </div>
            <div id="playlistAddButton-{{ playlist.id }}"class="playlistDetailsButton btn btn-default col-xs-3" ng-click="addToPlaylist(playlist)">
              Add Idea
            </div>
            <div id="playlistAdded-{{ playlist.id }}" class="playlistDetailsButton col-xs-3" style="display: none; padding-top: 5px">
              Added
            </div>

          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<add-playlist-modal></add-playlist-modal>

<!-- End of Add to Playlist Modal -->

<script type="text/javascript">
  $(document).ready(function() {
    $("#file-" + CURRENT_FILE.id).addClass("playListFileSelected");
    /*
    $(".playListFile").click(function() {
      console.log("dude");
      $(".playListFile").removeClass("playListFileSelected");
      $(this).addClass("playListFileSelected");
    });*/

  });
  getElementById("audio").addEventListener('canplaythrough', function() {
    getElementById("audio").play();
  }, false);
</script>
<script src="js/managers/uploader.js" type="text/javascript"></script>
